# NATS Configuration for DreamNet Agent Message Bus

server_name: agent-message-bus-1
port: 4222
http_port: 8222

# Jetstream enabled for persistence
jetstream {
  store_dir: /data
  max_memory_store: 1GB
  max_file_store: 10GB
}

# Cluster mode (for high availability)
cluster {
  name: dreamnet-cluster
  listen: 0.0.0.0:6222
  routes: [
    nats://agent-message-bus-2:6222,
    nats://agent-message-bus-3:6222
  ]
}

# System account
accounts {
  $SYS {
    users: [
      { user: sys, password: $SYS_PASS }
    ]
  }
  
  DreamNet {
    users: [
      { user: dreamnet, password: $DREAMNET_PASS }
    ]
    
    exports: [
      { service: "agent.>" }
      { service: "task.>" }
      { service: "memory.>" }
    ]
    
    imports: [
      { service: { account: "$SYS", subject: "account.*.info" }, to: "account.info" }
    ]
  }
}

# Default user
default_user: dreamnet
default_password: $DREAMNET_PASS
