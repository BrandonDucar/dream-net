[build]
builder = "nixpacks"
# Build the server and its dependencies (skipping client)
buildCommand = "pnpm install && pnpm --filter @dreamnet/server... run build"

[deploy]
startCommand = "pnpm --filter @dreamnet/server run start"
restartPolicyType = "ON_FAILURE"
restartPolicyMaxRetries = 3

[[services]]
name = "keystone-core"
# Use Repo Root so pnpm workspace is visible
root = "."

[[services]]
name = "god-view-client"
root = "client"
buildCommand = "pnpm install && pnpm run build"
startCommand = "pnpm run start"
